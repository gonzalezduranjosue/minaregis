<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="https://lucide.dev/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- SEO Principal -->
    <title>Sistema TI // Inventario RPG Gamificado</title>
    <meta name="description" content="Acceso al sistema de control de inventario gamificado estilo Cyberpunk/RPG. Resuelve el acertijo para entrar y gestionar equipos de oficina." />
    
    <!-- Librerías Externas (CDN) para ejecución sin build -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Configuración Tailwind -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              'pixel': ['"Press Start 2P"', 'cursive'],
              'terminal': ['"VT323"', 'monospace'],
            },
            colors: {
              'retro-bg': '#0d0e15',
              'retro-green': '#4ade80',
              'retro-green-dark': '#22c55e',
              'retro-purple': '#c084fc',
              'retro-pink': '#f472b6',
              'retro-card': '#1a1c29',
            },
            animation: {
              'blink': 'blink 1s step-end infinite',
              'glitch': 'glitch 0.3s cubic-bezier(.25, .46, .45, .94) both infinite',
            },
            keyframes: {
              blink: {
                '0%, 100%': { opacity: '1' },
                '50%': { opacity: '0' },
              },
              glitch: {
                '0%': { transform: 'translate(0)' },
                '20%': { transform: 'translate(-2px, 2px)' },
                '40%': { transform: 'translate(-2px, -2px)' },
                '60%': { transform: 'translate(2px, 2px)' },
                '80%': { transform: 'translate(2px, -2px)' },
                '100%': { transform: 'translate(0)' }
              }
            }
          }
        }
      }
    </script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">

    <style>
      body { background-color: #0d0e15; color: #e2e8f0; }
      .scanlines {
        background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
        background-size: 100% 4px;
        position: fixed; pointer-events: none; top: 0; right: 0; bottom: 0; left: 0; z-index: 50; opacity: 0.15;
      }
      /* Ocultar barra de scroll en terminal */
      .scrollbar-hide::-webkit-scrollbar { display: none; }
      .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
  <script type="importmap">
{
  "imports": {
    "lucide-react": "https://esm.sh/lucide-react@^0.561.0",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.2",
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3",
    "vite": "https://esm.sh/vite@^7.3.0"
  }
}
</script>
</head>
  <body>
    <div class="scanlines"></div>
    
    <!-- CONTENIDO SEO / FALLBACK -->
    <div id="root">
      <div style="background-color: #0d0e15; min-height: 100vh; color: #4ade80; font-family: monospace; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; text-align: center;">
        <h1 style="font-size: 2rem; margin-bottom: 20px;">SISTEMA TI // INVENTARIO RPG</h1>
        <p style="max-width: 600px; margin-bottom: 20px;">Cargando módulos del sistema...</p>
        <noscript>Se requiere JavaScript para acceder al sistema.</noscript>
      </div>
    </div>

    <!-- LÓGICA DE LA APLICACIÓN -->
    <script type="text/babel" data-type="module">
      import React, { useState, useEffect, useRef } from 'https://esm.sh/react@18.2.0';
      import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';
      import { Terminal, Lock, Skull, Shield, Cpu, Wifi, HardDrive, Monitor, Plus, Trash2, Power, Battery, Save, MapPin, Barcode } from 'https://esm.sh/lucide-react@0.344.0';

      // --- COMPONENTE: LoginTerminal ---
      const LoginTerminal = ({ onLoginSuccess }) => {
        const [input, setInput] = useState('');
        const [logs, setLogs] = useState([
          "INICIANDO SISTEMA...",
          "CARGANDO KERNEL...",
          "VERIFICANDO PERMISOS DE ROOT...",
          "ACCESO DENEGADO. PROTOCOLO DE SEGURIDAD GAMMA ACTIVADO.",
          "SE REQUIERE IDENTIFICACIÓN."
        ]);
        const [error, setError] = useState(false);
        const scrollRef = useRef(null);
        const RIDDLE_ANSWER = "teclado";

        useEffect(() => {
          if (scrollRef.current) {
            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;
          }
        }, [logs]);

        const handleSubmit = (e) => {
          e.preventDefault();
          const cleanInput = input.trim().toLowerCase();
          if (cleanInput === '') return;

          setLogs(prev => [...prev, `> ${input}`]);
          setInput('');

          if (cleanInput === RIDDLE_ANSWER) {
            setLogs(prev => [...prev, "ACCESO CONCEDIDO. BIENVENIDO, ADMIN.", "CARGANDO INTERFAZ GRÁFICA..."]);
            setTimeout(() => onLoginSuccess("Admin"), 1500);
          } else {
            setError(true);
            setLogs(prev => [...prev, "RESPUESTA INCORRECTA. INTRUSO DETECTADO.", "INTÉNTALO DE NUEVO."]);
            setTimeout(() => setError(false), 500);
          }
        };

        return (
          <div className="flex flex-col items-center justify-center min-h-screen p-4 text-green-500">
            <div className={`w-full max-w-2xl border-4 border-retro-green bg-black p-4 shadow-[0_0_20px_rgba(74,222,128,0.3)] rounded-lg ${error ? 'animate-glitch border-red-500 text-red-500' : ''}`}>
              <div className="flex items-center justify-between border-b-2 border-green-800 pb-2 mb-4">
                <div className="flex items-center gap-2">
                  <Terminal size={20} />
                  <span className="font-pixel text-xs md:text-sm">TERMINAL_ACCESO_V1.0</span>
                </div>
                <div className="flex gap-2">
                  <div className="w-3 h-3 bg-red-500 rounded-full"></div>
                  <div className="w-3 h-3 bg-yellow-500 rounded-full"></div>
                  <div className="w-3 h-3 bg-green-500 rounded-full"></div>
                </div>
              </div>

              <div ref={scrollRef} className="h-64 overflow-y-auto font-terminal text-lg md:text-xl space-y-1 mb-6 scrollbar-hide">
                {logs.map((log, index) => (
                  <div key={index} className="opacity-90">{log}</div>
                ))}
              </div>

              <div className="border border-green-900 bg-green-900/10 p-4 mb-4 rounded">
                <div className="flex items-start gap-3">
                  <Lock className="shrink-0 mt-1" />
                  <div>
                    <h3 className="font-bold text-xl mb-2 glitch-text">ACERTIJO DEL GUARDIÁN:</h3>
                    <p className="text-lg italic opacity-80">
                      "Tengo llaves pero no abro cerraduras. <br/>
                      Tengo espacio pero no habitaciones. <br/>
                      Puedes entrar, pero nunca salir. <br/>
                      ¿Qué soy?"
                    </p>
                  </div>
                </div>
              </div>

              <form onSubmit={handleSubmit} className="flex items-center gap-2 text-xl">
                <span className="animate-blink">_</span>
                <input
                  type="text"
                  value={input}
                  onChange={(e) => setInput(e.target.value)}
                  className="flex-1 bg-transparent border-none outline-none text-green-400 font-terminal uppercase placeholder-green-900"
                  placeholder="ESCRIBE LA CLAVE..."
                  autoFocus
                />
              </form>
            </div>
          </div>
        );
      };

      // --- COMPONENTE: GameDashboard ---
      const INITIAL_LOOT = [
        { id: 1, name: 'DELL-OPTIPLEX-7090', type: 'PC', status: 'Operativo', level: 8, rarity: 'rare', location: 'OFICINA 101', serialNumber: 'CN-0M5F4T-701' },
        { id: 2, name: 'THINKPAD-X1', type: 'Laptop', status: 'Operativo', level: 10, rarity: 'legendary', location: 'SALA JUNTAS', serialNumber: 'PF-2X99L-X1' },
        { id: 3, name: 'HP-MONITOR-24', type: 'Periférico', status: 'Dañado', level: 2, rarity: 'common', location: 'ALMACÉN B', serialNumber: 'CN-4430-X-00' },
      ];

      const GameDashboard = ({ username, onLogout }) => {
        const [inventory, setInventory] = useState(INITIAL_LOOT);
        const [showCraftModal, setShowCraftModal] = useState(false);
        const [newItemName, setNewItemName] = useState('');
        const [newItemType, setNewItemType] = useState('PC');
        const [newItemRarity, setNewItemRarity] = useState('common');
        const [newItemLocation, setNewItemLocation] = useState('');
        const [newItemSerialNumber, setNewItemSerialNumber] = useState('');

        const addItem = (e) => {
          e.preventDefault();
          const newItem = {
            id: Date.now(),
            name: newItemName.toUpperCase(),
            type: newItemType,
            status: 'Operativo',
            level: Math.floor(Math.random() * 10) + 1,
            rarity: newItemRarity,
            location: newItemLocation.toUpperCase() || 'SIN ASIGNAR',
            serialNumber: newItemSerialNumber.toUpperCase() || `SN-${Math.floor(Math.random() * 100000)}`,
          };
          setInventory([...inventory, newItem]);
          setShowCraftModal(false);
          setNewItemName('');
          setNewItemLocation('');
          setNewItemSerialNumber('');
        };

        const deleteItem = (id) => {
          setInventory(inventory.filter(item => item.id !== id));
        };

        const getRarityColor = (rarity) => {
          switch (rarity) {
            case 'legendary': return 'border-yellow-500 text-yellow-500 shadow-yellow-500/20';
            case 'rare': return 'border-retro-purple text-retro-purple shadow-retro-purple/20';
            default: return 'border-gray-500 text-gray-400 shadow-gray-500/20';
          }
        };

        const getRarityLabel = (rarity) => {
          switch (rarity) {
            case 'legendary': return 'LEGENDARIO';
            case 'rare': return 'RARO';
            default: return 'COMÚN';
          }
        };

        const getIcon = (type) => {
          switch (type) {
            case 'PC': return <Cpu />;
            case 'Laptop': return <HardDrive />;
            case 'Servidor': return <Wifi />;
            default: return <Monitor />;
          }
        };

        return (
          <div className="min-h-screen bg-retro-bg text-retro-green font-terminal p-4 md:p-8">
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
              <div className="border-4 border-retro-green bg-retro-card p-4 rounded-xl flex items-center gap-4 relative overflow-hidden">
                <div className="absolute top-0 right-0 p-1 bg-retro-green text-black font-pixel text-[10px]">NVL 99</div>
                <div className="w-16 h-16 bg-green-900 rounded-full flex items-center justify-center border-2 border-retro-green">
                  <Shield className="w-8 h-8 animate-pulse" />
                </div>
                <div>
                  <h2 className="text-xl font-bold font-pixel text-white">{username}</h2>
                  <div className="flex items-center gap-2 text-sm mt-1">
                    <span className="text-retro-purple">ROL:</span> ADMIN SIS
                  </div>
                  <div className="w-32 h-2 bg-gray-700 mt-2 rounded-full overflow-hidden">
                    <div className="h-full bg-gradient-to-r from-green-500 to-yellow-500 w-[90%]"></div>
                  </div>
                </div>
              </div>

              <div className="border-4 border-retro-green bg-retro-card p-4 rounded-xl flex flex-col justify-center">
                <h3 className="font-pixel text-xs text-retro-green mb-2">ESTADO DEL SISTEMA</h3>
                <div className="flex justify-between items-end border-b border-green-800 pb-2">
                  <span>UNIDADES ACTIVAS:</span>
                  <span className="text-2xl font-bold text-white">{inventory.filter(i => i.status === 'Operativo').length}</span>
                </div>
                <div className="flex justify-between items-end pt-2">
                  <span className="text-red-400">UNIDADES DAÑADAS:</span>
                  <span className="text-xl font-bold text-red-400">{inventory.filter(i => i.status !== 'Operativo').length}</span>
                </div>
              </div>

              <div className="flex flex-col gap-2">
                 <button 
                  onClick={() => setShowCraftModal(true)}
                  className="flex-1 bg-retro-green hover:bg-green-400 text-black font-pixel text-sm flex items-center justify-center gap-2 rounded border-b-4 border-green-800 active:border-b-0 active:translate-y-1 transition-all"
                >
                  <Plus size={16} /> REGISTRAR EQUIPO
                </button>
                <button 
                  onClick={onLogout}
                  className="h-12 border-2 border-red-500 hover:bg-red-500/10 text-red-500 font-pixel text-xs flex items-center justify-center gap-2 rounded"
                >
                  <Power size={16} /> CERRAR SESIÓN
                </button>
              </div>
            </div>

            <div className="border-4 border-retro-purple bg-black/50 p-6 rounded-xl relative min-h-[500px]">
              <h2 className="absolute -top-5 left-8 bg-retro-bg px-4 text-retro-purple font-pixel text-lg border-2 border-retro-purple">INVENTARIO</h2>
              
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mt-4">
                {inventory.map((item) => (
                  <div key={item.id} className={`bg-retro-card border-2 p-4 rounded-lg relative group transition-all hover:scale-105 hover:z-10 flex flex-col ${getRarityColor(item.rarity)}`}>
                    <div className="flex justify-between items-start mb-2">
                       <div className="bg-black/40 p-2 rounded">{getIcon(item.type)}</div>
                       <span className="font-pixel text-[10px] uppercase opacity-70">{getRarityLabel(item.rarity)}</span>
                    </div>

                    <h3 className="font-bold text-xl truncate mb-1 text-white" title={item.name}>{item.name}</h3>
                    <div className="text-sm opacity-80 mb-4 border-b border-gray-700 pb-2">{item.type}</div>

                    <div className="space-y-2 mb-4 text-xs font-mono bg-black/20 p-2 rounded">
                      <div className="flex items-center gap-2">
                        <MapPin size={12} className="shrink-0" />
                        <span className="truncate">{item.location}</span>
                      </div>
                      <div className="flex items-center gap-2">
                        <Barcode size={12} className="shrink-0" />
                        <span className="truncate">{item.serialNumber}</span>
                      </div>
                    </div>

                    <div className="space-y-1 mb-4 mt-auto">
                      <div className="flex justify-between text-xs">
                        <span>NVL PODER</span>
                        <span>{item.level}</span>
                      </div>
                      <div className="h-1 bg-gray-700 w-full rounded">
                        <div className="h-full bg-current w-[60%]"></div>
                      </div>
                    </div>

                    <div className={`inline-block px-2 py-1 text-xs rounded border text-center ${
                      item.status === 'Operativo' ? 'border-green-500 text-green-500 bg-green-500/10' : 'border-red-500 text-red-500 bg-red-500/10 animate-pulse'
                    }`}>
                      [{item.status}]
                    </div>

                    <button 
                      onClick={() => deleteItem(item.id)}
                      className="absolute top-2 right-2 opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-400 transition-opacity"
                      title="Desmantelar Item"
                    >
                      <Trash2 size={18} />
                    </button>
                  </div>
                ))}
                
                {inventory.length === 0 && (
                   <div className="col-span-full flex flex-col items-center justify-center text-gray-600 py-20">
                     <div className="text-6xl mb-4">☹</div>
                     <p className="font-pixel text-sm">INVENTARIO VACÍO</p>
                   </div>
                )}
              </div>
            </div>

            {showCraftModal && (
              <div className="fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4">
                <div className="bg-retro-card border-4 border-retro-pink w-full max-w-md p-6 rounded-xl shadow-[0_0_50px_rgba(244,114,182,0.3)] max-h-[90vh] overflow-y-auto">
                  <h2 className="font-pixel text-retro-pink text-center mb-6 text-lg">REGISTRAR EQUIPO</h2>
                  
                  <form onSubmit={addItem} className="space-y-4">
                    <div>
                      <label className="block text-sm mb-1 text-retro-pink">NOMBRE DEL EQUIPO</label>
                      <input 
                        autoFocus
                        type="text" 
                        value={newItemName}
                        onChange={(e) => setNewItemName(e.target.value)}
                        className="w-full bg-black border-2 border-retro-pink/50 text-white p-2 font-terminal text-xl focus:border-retro-pink focus:outline-none uppercase"
                        placeholder="Ej. SERVIDOR-01"
                        required
                      />
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                      <div>
                        <label className="block text-sm mb-1 text-retro-pink">NÚMERO DE SERIE</label>
                        <input 
                          type="text" 
                          value={newItemSerialNumber}
                          onChange={(e) => setNewItemSerialNumber(e.target.value)}
                          className="w-full bg-black border-2 border-retro-pink/50 text-white p-2 font-terminal text-sm focus:border-retro-pink focus:outline-none uppercase"
                          placeholder="S/N..."
                          required
                        />
                      </div>
                      <div>
                        <label className="block text-sm mb-1 text-retro-pink">UBICACIÓN</label>
                        <input 
                          type="text" 
                          value={newItemLocation}
                          onChange={(e) => setNewItemLocation(e.target.value)}
                          className="w-full bg-black border-2 border-retro-pink/50 text-white p-2 font-terminal text-sm focus:border-retro-pink focus:outline-none uppercase"
                          placeholder="OFICINA..."
                          required
                        />
                      </div>
                    </div>

                    <div>
                      <label className="block text-sm mb-1 text-retro-pink">CLASE / TIPO</label>
                      <select 
                        value={newItemType}
                        onChange={(e) => setNewItemType(e.target.value)}
                        className="w-full bg-black border-2 border-retro-pink/50 text-white p-2 font-terminal text-xl focus:border-retro-pink focus:outline-none"
                      >
                        <option value="PC">PC / Estación</option>
                        <option value="Laptop">Laptop / Portátil</option>
                        <option value="Servidor">Servidor Mainframe</option>
                        <option value="Periférico">Periférico / Acc</option>
                      </select>
                    </div>

                    <div>
                      <label className="block text-sm mb-1 text-retro-pink">RAREZA</label>
                      <div className="flex gap-2">
                        {['common', 'rare', 'legendary'].map(r => (
                          <button
                            key={r}
                            type="button"
                            onClick={() => setNewItemRarity(r)}
                            className={`flex-1 py-2 text-xs font-pixel uppercase border-2 ${
                              newItemRarity === r 
                                ? 'bg-retro-pink text-black border-retro-pink' 
                                : 'border-gray-700 text-gray-500 hover:border-retro-pink/50'
                            }`}
                          >
                            {getRarityLabel(r)}
                          </button>
                        ))}
                      </div>
                    </div>

                    <div className="flex gap-4 mt-8">
                      <button 
                        type="button"
                        onClick={() => setShowCraftModal(false)}
                        className="flex-1 py-3 border-2 border-gray-600 text-gray-400 font-pixel text-xs hover:bg-gray-800"
                      >
                        CANCELAR
                      </button>
                      <button 
                        type="submit"
                        className="flex-1 py-3 bg-retro-pink text-black font-pixel text-xs hover:bg-pink-400 border-2 border-retro-pink shadow-[0_0_15px_rgba(244,114,182,0.5)]"
                      >
                        GUARDAR
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            )}
          </div>
        );
      };

      // --- COMPONENTE: App ---
      const App = () => {
        const [isAuthenticated, setIsAuthenticated] = useState(false);
        const [user, setUser] = useState('');

        const handleLoginSuccess = (username) => {
          setUser(username);
          setIsAuthenticated(true);
        };

        return (
          <div className="min-h-screen bg-retro-bg font-terminal overflow-x-hidden selection:bg-retro-green selection:text-black">
            {!isAuthenticated ? (
              <LoginTerminal onLoginSuccess={handleLoginSuccess} />
            ) : (
              <GameDashboard username={user} onLogout={() => setIsAuthenticated(false)} />
            )}
          </div>
        );
      };

      // --- MOUNT ---
      const root = createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>